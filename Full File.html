<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Center Choices</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- GOOGLE FONT -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">

       <style>
     /* General styling for the body */
        body {
            font-family: 'Quicksand',sans-serif; /* Sets the font style */
            background-color: white; /* Sets the background color */
            color: black; /* Sets the text color */
            border: 5px solid black; /* Adjust width, style, and color as needed */
        }

        /* Styling for the heading */
        h2 {
            margin: 15px 0; /* Adds margin above and below the heading */
            text-align: center; /* Centers the heading text */
            caret-color: transparent; /* Hides the text cursor */
            font-size: 5vw; /* Sets the font size relative to the viewport width */
            color: white; /* Sets the text color */
            text-shadow: 2px 2px 0 #000, -2px 2px 0 #000, 2px -2px 0 #000, -2px -2px 0 #000; /* Black outline */
        }

        @media (max-width: 768px) {
        h2 {
            font-size: 5vw; /* Increase font size for smaller screens */
        }
    }

        /* Styling for tables */
        table {
            border: 2px solid black; /* Adds a black border to the table */
            border-collapse: collapse; /* Ensures borders are collapsed */
            width: 400px; /* Sets the table width */
            height: 200px; /* Sets the table height */
            text-align: center;
            font-size: 2.5vw; /* Font size relative to the viewport width */
            color: black;
            font-weight: regular; /* Centers the text inside the table */
        }

        /* Responsive styling for smaller screens */
        @media (max-width: 768px) {
            table {
                width: 90%; /* Adjusts table width for smaller screens */
                height: auto;
                 /* Allows table height to adjust automatically */
            }
        }

        /* Styling for table cells */
        td {
            border: 2px solid black; /* Adds a black border to table cells */
        }

        /* Styling for draggable container */
        .draggable-container {
            display: flex; /* Enables flexbox layout */
            flex-wrap: wrap; /* Allows wrapping of elements */
            justify-content: center; /* Centers the content */
            gap: 10px; /* Adds spacing between elements */
            padding: 15px; /* Adds padding around the container */
        }

        /* Styling for draggable columns */
        .draggable-columns {
            display: flex; /* Enables flexbox layout */
            justify-content: space-around; /* Distributes columns evenly */
            flex-wrap: wrap; /* Allows wrapping of columns */
            margin-top: 20px; /* Adds space above the columns */
        }

        /* Styling for draggable elements */
        .draggable {
            position: absolute; /* Keeps the draggable objects positioned relative to the parent container */
            top: 10%; /* Position relative to the viewport height */
            left: 10%; /* Position relative to the viewport width */
            width: 10vw; /* Width relative to the viewport width */
            height: 5vh; /* Height relative to the viewport height */
            background-color: transparent; /* Makes the background transparent */
            border: transparent; /* Removes the border */
            display: flex; /* Enables flexbox layout */
            justify-content: center; /* Centers content horizontally */
            align-items: center; /* Centers content vertically */
            cursor: pointer; /* Changes the cursor to a hand when hovering */
        } 
        
        .draggable img {
    width: 100%; /* Make the image fill the draggable container */
    height: auto; /* Maintain the aspect ratio */
}

        .draggable span {
            font-size: 2.5vw; /* Font size relative to the viewport width */
            color: black;
            font-weight: regular;
            text-align: center;
            width: 100%; /* Add this line to make the label span the full width of the container */
            display: block; /* Ensure the span behaves like a block element */
            white-space: nowrap; /* Prevents text from wrapping */
        }
        

    @media (max-width: 768px) {
        .draggable {
            width: 15vw; /* Adjust width for smaller screens */
            height: 7vh; /* Adjust height for smaller screens */
            top: 15%; /* Adjust position for smaller screens */
            left: 5%; /* Adjust position for smaller screens */
        }
    }
    .draggable {
    touch-action: none; /* allows dragging with touch */
}
        /* PATCH #1 ‚Äî Disable native long-press copy/save/select menus */
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>

    <h2>Daily Schedule</h2> <!-- Main heading of the page -->


<div style="display: flex; justify-content: center; margin-top: 240px;">
  
  <table id="table1" border="1" style="width: 80px; border-collapse: collapse; text-align: center; border-style: hidden; margin-right: 30px;">
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
  </table>

  <table id="table2" border="1" style="width: 400px; border-collapse: collapse; text-align: center; margin-right: 60px;">
      <tr><td style="height: 80px;"></td></tr>
      <tr><td style="height: 80px;"></td></tr>
      <tr><td style="height: 80px;"></td></tr>
      <tr><td style="height: 80px;"></td></tr>
  </table>

  <table id="table3" border="1" style="width: 80px; border-collapse: collapse; text-align: center; border-style: hidden; margin-right: 30px; ">
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
      <tr><td style="height: 80px;"><span>8:00</span></td></tr>
  </table>

  <table id="table4" border="1" style="width: 400px; border-collapse: collapse; text-align: center; ">
      <tr><td style="height: 80px;"></td></tr>
      <tr><td style="height: 80px;"></td></tr>
      <tr><td style="height: 80px;"></td></tr>
      <tr><td style="height: 80px;"></td></tr>
  </table>

</div>

        <!-- Draggable Images with Labels -->

<div class="draggable" style="top: 5%; left: 5%;">
    <img src="Morning Meeting.png" alt="">
    <span>Morning Meeting</span>
</div>

<div class="draggable" style="top: 15%; left: 5%;">
    <img src="Math.png" alt="">
    <span>Math</span>
</div>

<div class="draggable" style="top: 25%; left: 5%;">
    <img src="Lunch.png" alt="">
    <span>Lunch</span>
</div>

<div class="draggable" style="top: 35%; left: 5%;">
    <img src="Circle Time.png" alt="">
    <span>Circle Time</span>
</div>

<div class="draggable" style="top: 5%; left: 80%;">
    <img src="Dismissal.png" alt="">
    <span>Dismissal</span>
</div>

<div class="draggable" style="top: 15%; left:80%;">
    <img src="Snack.png" alt="">
    <span>Snack</span>
</div>

<div class="draggable" style="top: 25%; left:80%;">
    <img src="Storytime.png" alt="">
    <span>Storytime</span>
</div>

<div class="draggable" style="top: 35%; left:80%;">
    <img src="Small Group.png" alt="">
    <span>Small Group
</div>

<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>

  <div id="customMenu" style="display: none; position: absolute; background: white; border: 1px solid rgb(204, 204, 204); box-shadow: rgba(0, 0, 0, 0.3) 2px 2px 5px; z-index: 9999; padding: 10px; left: 330px; top: 126px;">
    
    <div onclick="toggleTextToSpeech()" style="cursor:pointer;">üîä Toggle Text-to-Speech</div>
    <div onclick="enterFullscreen()"style="cursor:pointer;">‚õ∂ Enter Fullscreen</div>
    <div onclick="exitFullscreen()"style="cursor:pointer;">‚úñ Exit Fullscreen</div>
    <div onclick="editText()" style="cursor:pointer;">‚úèÔ∏è Edit Text</div> <!-- Edit text option -->
    <div onclick="editImage()" style="cursor:pointer;">üñºÔ∏è Edit Image</div> <!-- Edit image option -->
    <div onclick="savePage()" style="cursor:pointer;">üíæ Save This Layout</div> <!-- Save layout option -->
    <div onclick="duplicateObject()" style="cursor:pointer;">üìÑ Duplicate</div> <!-- ADDED: Duplicate menu item -->
    <div onclick="deleteObject()" style="cursor:pointer; color: red;">üóëÔ∏è Delete Object</div> <!-- Delete object option -->
</div>
  * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
   </head>
<body>
<script>
/* -------------------- Hidden Menu + Long Press System --------------------- */

function enableHiddenMenuAccess() {
    const LONG_PRESS_TIME = 1500;
    const VIBRATION_TIME = 100;
    let longPressTimer, pointerDownPos;

    const suppressContextMenu = (e) => {
        e.preventDefault();
        e.stopPropagation();
        return false;
    };

    document.addEventListener("contextmenu", suppressContextMenu, { capture: true });
    window.addEventListener("contextmenu", suppressContextMenu, { capture: true });

    const startPress = (x, y) => {
        clearTimeout(longPressTimer);
        longPressTimer = setTimeout(() => {
            if ("vibrate" in navigator) navigator.vibrate(VIBRATION_TIME);
            openHiddenMenu(x, y);
        }, LONG_PRESS_TIME);
    };

    const cancelPress = () => {
        clearTimeout(longPressTimer);
        longPressTimer = null;
    };

    document.addEventListener("pointerdown", (e) => {

      // PATCH ‚Äî Select draggable OR table cell
const draggable = e.target.closest(".draggable");
const cell = e.target.closest("td");

if (draggable) {
    selectedElement = draggable;
} else if (cell) {
    selectedElement = cell;
}

        if (e.pointerType === "mouse" && e.button !== 0) return;

        pointerDownPos = { x: e.clientX, y: e.clientY };
        startPress(e.clientX, e.clientY);

    }, { passive: true });

    document.addEventListener("pointermove", (e) => {
        if (!longPressTimer || !pointerDownPos) return;
        if (Math.hypot(e.clientX - pointerDownPos.x, e.clientY - pointerDownPos.y) > 30)
            cancelPress();
    }, { passive: true });

    document.addEventListener("pointerup", cancelPress, { passive: true });
    document.addEventListener("pointercancel", cancelPress, { passive: true });

    document.addEventListener("click", (e) => {
        if (e.ctrlKey) {
            e.preventDefault();
            openHiddenMenu(e.pageX, e.pageY);
        }
    });
}

enableHiddenMenuAccess();

/* PATCH #2 ‚Äî BLOCK native long-press copy/save/select */
document.addEventListener("touchstart", (e) => {
    if (!e.target.closest("#customMenu")) e.preventDefault();
}, { passive: false });

document.addEventListener("touchend", (e) => {
    if (!e.target.closest("#customMenu")) e.preventDefault();
}, { passive: false });

/* -------------------------------------------------------------------------- */

function openHiddenMenu(x, y) {
    const menu = document.getElementById("customMenu");
    if (!menu) return;
    menu.style.left = `${x}px`;
    menu.style.top = `${y}px`;
    menu.style.display = "block";
}
// text-to-speech toggle
let isTextToSpeechEnabled = true;

function toggleTextToSpeech() {
    isTextToSpeechEnabled = !isTextToSpeechEnabled;
    alert(`Text-to-Speech is now ${isTextToSpeechEnabled ? "enabled" : "disabled"}.`);
    hideMenu();
}

let preferredVoice = null;

function setPreferredVoice() {
    const voices = window.speechSynthesis.getVoices();
    preferredVoice = voices.find(v => v.name === "Google US English") || voices[0];
}

window.speechSynthesis.onvoiceschanged = setPreferredVoice;
setPreferredVoice();

function speakText(text) {
    if (!isTextToSpeechEnabled) return;
    const u = new SpeechSynthesisUtterance(text);
    u.voice = preferredVoice;
    speechSynthesis.speak(u);
}

document.addEventListener("click", (e) => {
    const menu = document.getElementById("customMenu");
    if (e.ctrlKey) {
        e.preventDefault();
        menu.style.left = `${e.pageX}px`;
        menu.style.top = `${e.pageY}px`;
        menu.style.display = "block";
    } else if (!menu.contains(e.target)) {
        hideMenu();
    }
});

function hideMenu() {
    const menu = document.getElementById("customMenu");
    if (menu) menu.style.display = "none";
}

// Close the hidden menu on any touch/pen/mouse press outside it
document.addEventListener("pointerdown", (e) => {
    const menu = document.getElementById("customMenu");
    if (!menu) return;

    // Only act if the menu is currently open
    if (menu.style.display !== "block") return;

    // Ignore presses inside the menu
    if (e.target.closest("#customMenu")) return;

    // Anything else closes it
    hideMenu();
});


function enterFullscreen() {
    if (!document.fullscreenElement) document.documentElement.requestFullscreen();
    hideMenu();
}

function exitFullscreen() {
    if (document.fullscreenElement) document.exitFullscreen();
    hideMenu();
}

/* ---------------------- SAVE LAYOUT ---------------------------- */

function savePage() {
    const els = [...document.querySelectorAll(".draggable")];

    els.forEach(el => {
        const style = getComputedStyle(el);
        el.setAttribute("data-top", style.top);
        el.setAttribute("data-left", style.left);
    });

    const clone = document.documentElement.cloneNode(true);
    const clonedEls = clone.querySelectorAll(".draggable");

    clonedEls.forEach((el, i) => {
        const orig = els[i];
        el.style.top = orig.getAttribute("data-top");
        el.style.left = orig.getAttribute("data-left");
        el.style.position = "fixed";
    });

    const blob = new Blob(["<!DOCTYPE html>\n" + clone.outerHTML], { type: "text/html" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "center-choices-saved.html";
    a.click();
    URL.revokeObjectURL(url);
    hideMenu();
}

/* ---------------------- EDIT / DUPLICATE / DELETE ---------------------------- */

let selectedElement = null;

document.addEventListener("click", (e) => {
    if (e.target.closest(".draggable")) {
        selectedElement = e.target.closest(".draggable");
    }
});

function editText() {
    if (!selectedElement) {
        alert("Select something first.");
        return;
    }

    // Case 1: Draggable with <span>
    const span = selectedElement.querySelector("span");
    if (span) {
        const newText = prompt("Edit text:", span.textContent);
        if (newText !== null) span.textContent = newText;
        hideMenu();
        return;
    }

    // Case 2: Table cell
    if (selectedElement.tagName === "TD") {
        const current = selectedElement.textContent.trim();
        const newText = prompt("Edit cell text:", current);
        if (newText !== null) selectedElement.textContent = newText;
        hideMenu();
        return;
    }

    alert("This item cannot be edited.");
    hideMenu();
}


function editImage() {
    if (!selectedElement) return alert("Select a draggable first.");
    const img = selectedElement.querySelector("img");
    if (!img) return alert("No image inside this draggable.");
    const url = prompt("Enter new image URL:", img.src);
    if (!url) return;
    try { new URL(url); img.src = url; }
    catch { alert("Invalid URL."); }
    hideMenu();
}

function duplicateObject() {
    if (!selectedElement) return alert("Select something first.");
    const rect = selectedElement.getBoundingClientRect();
    const clone = selectedElement.cloneNode(true);

    const newLeft = ((rect.left + 30) / innerWidth) * 100;
    const newTop  = ((rect.top + 30) / innerHeight) * 100;

    clone.style.left = `${newLeft}vw`;
    clone.style.top = `${newTop}vh`;

    document.body.appendChild(clone);
    attachDragHandlers(clone);
    selectedElement = clone;
    hideMenu();
}

function deleteObject() {
    if (!selectedElement) return alert("Select something first.");
    if (!confirm("Delete this object?")) return;
    selectedElement.remove();
    selectedElement = null;
    hideMenu();
}

/* ---------------------- DRAGGING ---------------------------- */

function attachDragHandlers(el) {
    let startX, startY, startLeft, startTop, dragging = false;

    el.onpointerdown = (e) => {
        e.preventDefault();
        dragging = true;
        el.setPointerCapture(e.pointerId);

        const r = el.getBoundingClientRect();
        startLeft = r.left;
        startTop = r.top;
        startX = e.clientX;
        startY = e.clientY;

        const span = el.querySelector("span");
        const img = el.querySelector("img");
        if (span) speakText(span.textContent);
        else if (img) speakText(img.alt);
    };

    el.onpointermove = (e) => {
        if (!dragging) return;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;

        el.style.left = ((startLeft + dx) / innerWidth) * 100 + "vw";
        el.style.top  = ((startTop + dy) / innerHeight) * 100 + "vh";
    };

    el.onpointerup = el.onpointercancel = (e) => {
        dragging = false;
        el.releasePointerCapture(e.pointerId);
    };
}

document.querySelectorAll(".draggable").forEach(attachDragHandlers);

</script>

</body>
</html>


